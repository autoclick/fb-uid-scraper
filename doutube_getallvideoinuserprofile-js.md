---
title: "Doutube_getAllVideoInUserProfile.Js"
date: "2023-11-23"
categories: 
  - "useful-script-en"
---

how to add bookmarklet in chrome  
![](https://camo.githubusercontent.com/5f21e427a7d3ee887313a4f9b1ab033e6462db47ca299bf3f7e2d81a0ce854bd/68747470733a2f2f696d672e7765626e6f74732e636f6d2f323031392f30342f447261672d616e642d44726f702d4c696e6b732d696e2d4368726f6d652e706e67)`import { runScriptInCurrentTab, showLoading } from "./helpers/utils.js";  export default { icon: "https://s2.googleusercontent.com/s2/favicons?domain=doutu.be", name: { en: "Get all video from user profile",  vi: "Get all video in doutu.be user profile", en: "Download all videos from any doutu.be user's profile",  }, whiteList: ["https://doutu.be/*"],  onClickExtension: async function() { const { zipAndDownloadBlobs, getBlobFromUrl } = UsefulScriptGlobalPageContext.Utils;  let user_id = await runScriptInCurrentTab(() => { let url = window.location.href;  let id = url.split("/u/")?. [1]; return ID; });  if (!user_id) { alert( "User id not found from url.\nPlease go to user profile page doutu.be\n\nVD: https://doutu.be/u/123456789 " ); return; }  let hasNextPage = true; let page = 1; let skip = 0; let videos = [];  const { closeLoading, setLoadingText } = showLoading("Looking for video..."); while (hasNextPage) {  try { let url = 'https://api.doutu.be/api/video/?author=${user_id}&skips=${skip}'; let response = await fetch(url); let data = await response.json();  if (data?. length) { data.forEach((d) => { videos.push(d); });  skip += data.length; page++; setLoadingText( 'Looking for the ${page} page. Found ${videos.length} videos...' ); } else { hasNextPage = false; } } catch (e) { alert("Error: " + e); Break; } }  console.log(videos); if (!videos.length) { alert("No video found"); } else if ( !confirm( 'Found ${videos.length} videos. Click OK to start the loading process ' ) ) { closeLoading(); } else { let blobs = []; for ( let i = 0; i < videos.length; i++) { let v = videos[i]; let id = v._id; let url = v.playUrl || v.videoMP4URL; setLoadingText('Loading video ${id}...'); let blob = await getBlobFromUrl(url); blobs.push({ Blob fileName: '${i}_${id}.mp4', }); } setLoadingText('Compressing...'); zipAndDownloadBlobs( Blobs 'doutube_${user_id}.zip', (progress) => { setLoadingText( 'Compressing... ${progress}% Please do not disable this popup ' ); }, () => { closeLoading();  } ); } }, };`
