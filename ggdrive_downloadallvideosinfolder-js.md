---
title: "GgDrive_downloadAllVideosInFolder.Js"
date: "2023-11-23"
categories: 
  - "useful-script-en"
---

how to add bookmarklet in chrome  
![](https://camo.githubusercontent.com/5f21e427a7d3ee887313a4f9b1ab033e6462db47ca299bf3f7e2d81a0ce854bd/68747470733a2f2f696d672e7765626e6f74732e636f6d2f323031392f30342f447261672d616e642d44726f702d4c696e6b732d696e2d4368726f6d652e706e67)``import { openPopupWithHtml, runScriptInCurrentTab, showLoading, } from “./helpers/utils.js”; import { getTableStyle } from “./helpers/predefined_css.js”; import { shared as ggdrive_downloadVideo } from “./ggdrive_downloadVideo.js”;  export default { icon: “https://drive.google.com/favicon.ico”, name: { en: “GGDrive – Download all videos in folder”, vi: “GGDrive – Tải mọi video trong folder”, }, description: { en: “Download all videos in folder of google drive (bypass download permission)”, vi: “Tải tất cả video trong thư mục google drive (tải được video không cho phép tải)”, },  onClickExtension: async function () { // Post: https://www.facebook.com/groups/j2team.community/posts/974953859503401/  let { closeLoading, setLoadingText } = showLoading( “Đang tìm tất cả video trong folder…” ); try { // =========== Prepare data: Query all docid from website =========== let allDocs = await runScriptInCurrentTab(() => Array.from(document.querySelectorAll(“.iZmuQc .WYuW0e”)).map((_) => ({ id: _.dataset.id, name: _.innerText, })) ); if (!allDocs?.length) throw Error(“Không tìm được video nào.”);  // =========== Fetch Data =========== let errors = []; let result = []; for (let i = 0; i < allDocs.length; i++) { let { id, name } = allDocs[i]; setLoadingText( `Tìm thấy ${allDocs.length} videos. Đang tìm link video ${i + 1}…  ${name}  Lỗi: ${errors.length} video  ${errors.map(({ id, name, e }) => name).join(“ “)}  ` ); try { // prettier-ignore let videoInfo = await ggdrive_downloadVideo.getLinkVideoGDriveFromDocId(id); result.push({ id, name, videoInfo }); } catch (e) { errors.push({ id, name, e }); } }  // =========== Render Data =========== let allUrls = {}; let tableHtml = result .map((data, i) => { const { id, name, videoInfo } = data; let link = shared.generateLinkFromDocId(id);  let videosColumn = videoInfo .map(({ quality, url }) => { if (!(quality in allUrls)) allUrls[quality] = []; allUrls[quality].push(url); return `${quality}`; }) .join(“ “);  return `  ${i + 1} ${name} ${videosColumn}  `; }) .join(“”);  let allUrlsHtml = Object.entries(allUrls) .map(([quality, urls], index) => { urls = urls.join(“\n”); return `  ${quality}  `; }) .join(“ “);  let html = `  Tải tất cả (Copy paste vào IDM hoặc FDM để tải toàn bộ)  ${allUrlsHtml}  Tải từng video  ${tableHtml}  # Link Videos  `; openPopupWithHtml(html, 700, 500); } catch (e) { alert(“ERROR: ” + e); } finally { closeLoading(); } }, };  export const shared = { generateLinkFromDocId: function (docId, mode = “view”) { return `https://drive.google.com/file/d/${docId}/${mode}`; }, };``
