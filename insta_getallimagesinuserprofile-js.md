---
title: "Insta_getAllImagesInUserProfile.Js"
date: "2023-11-23"
categories: 
  - "useful-script-en"
---

how to add bookmarklet in chrome  
![](https://camo.githubusercontent.com/5f21e427a7d3ee887313a4f9b1ab033e6462db47ca299bf3f7e2d81a0ce854bd/68747470733a2f2f696d672e7765626e6f74732e636f6d2f323031392f30342f447261672d616e642d44726f702d4c696e6b732d696e2d4368726f6d652e706e67)`export default { name: { en: “Get all images in insta user profile”, vi: “Tải tất cả ảnh insta user profile”, }, description: { en: “Get all images in instagram user profile”, vi: “Tải tất cả ảnh có trong profile của user instagram bất kỳ”, },  onClick: async function () { const WAIT_FOR_MODAL_IMG_LOAD = 5000; const FIND_IMG_IN_MODAL_INTERVAL = 100; const getOriginalVideoFromBlob = (videoEl) => { const instanceKey = Object.keys(videoEl).find((key) => key.includes(“Instance”) ); const $react = videoEl[instanceKey]; const videoLink = $react.return.memoizedProps.fallbackSrc; return videoLink; }; const getAllClickableDiv = () => Array.from(document.querySelectorAll(“div._9AhH0”)) || []; const getMediaInViewport = () => document.querySelector(“article[role=’presentation’] div.KL4Bh>img”) || document.querySelector(“article[role=’presentation’] div.E-66r>video”); const sleep = (milliseconds) => { return new Promise((resolve) => setTimeout(resolve, milliseconds)); }; window.onblur = function () { has_focus = false; }; window.onfocus = function () { has_focus = true; }; let has_focus = true; const queue = getAllClickableDiv(); const done = []; const urls = []; while (queue.length > 0) { const first = queue.shift(); first.scrollIntoView(); first.click(); done.push(first); const new_img = getAllClickableDiv().filter( (_) => done.indexOf(_) == -1 && queue.indexOf(_) == -1 ); queue.push(…new_img); let media; let limit = WAIT_FOR_MODAL_IMG_LOAD / FIND_IMG_IN_MODAL_INTERVAL; while ((!media && limit > 0) || !has_focus) { media = getMediaInViewport(); limit–; await sleep(FIND_IMG_IN_MODAL_INTERVAL); } if (media) { console.log(media.tagName); if (media.tagName == “VIDEO”) { const url = getOriginalVideoFromBlob(media); urls.push(url); console.log(url); window.open(url); window.focus(); } if (media.tagName == “IMG”) { urls.push(media.src); console.log(media.src); } } document.querySelector(“div.Igw0E>button.wpO6b”)?.click(); } console.log(urls); }, };`
