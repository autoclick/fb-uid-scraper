---
title: "Shopee_totalSpendMoney_excel.Js"
date: "2023-11-23"
categories: 
  - "useful-script-en"
---

how to add bookmarklet in chrome  
![](https://camo.githubusercontent.com/5f21e427a7d3ee887313a4f9b1ab033e6462db47ca299bf3f7e2d81a0ce854bd/68747470733a2f2f696d672e7765626e6f74732e636f6d2f323031392f30342f447261672d616e642d44726f702d4c696e6b732d696e2d4368726f6d652e706e67)`export default { icon: "https://shopee.vn/favicon.ico", name: { en: "Shopee – Export order history (Excel)", vi: "Shopee – Export order history (Excel)", }, description: {  en: "Export all of your order history from Shopee to Excel file", vi: "Export order history from Shopee to Excel file",  },  infoLink: "https://www.facebook.com/groups/j2team.community/posts/2222766368055471/", whiteList: ["https://shopee.vn/*"],  onClick: async () => { // https://pastecode.io/s/7cpgip63 /  / https://www.facebook.com/groups/j2team.community/posts/2222766368055471/  async function getOrders(offset, limit) { let url = "https://shopee.vn/api/v4/order/get_all_order_and_checkout_list?limit=" + limit + "&offset=  " + offset; var ordersData = (await(await fetch(url)).json()).data.order_data;  var detailList = ordersData.details_list; if (detailList) { return detailList; } else {  return [];  } } function _VietNamCurrency(number) { return new Intl.NumberFormat("en-US", { style: "currency", currency: "VND",  }).format(number); } async function getAllOrders() { const limit = 20; let offset = 0; let allOrders = []; allOrders.push( [ "Common name", "Quantity", "Total amount", "Status", "Shop name", "Details", "Principal",  ].join("\t") ); let sum = 0; let count = 0;  while (true) { let data = await getOrders(offset, limit); if (data.length == 0) break; for (const item of data) { const infoCard = item.info_card; const listType = item.list_type; let strListType; switch (listType) { case 3: strListType = "Complete"; break; case 4: strListType = "Cancelled"; break; case 7: strListType = "Shipping"; break;  case 8:  strListType = "Delivering”; Break; case 9: strListType = "Waiting for payment"; Break; case 12: strListType = "Returns"; Break; default: strListType = "Unknown"; Break; }  const productCount = infoCard.product_count; let subTotal = infoCard.subtotal / 1e5; count += productCount; const orderCard = infoCard.order_list_cards[0]; const shopName = orderCard.shop_info.username + ” – ” + orderCard.shop_info.shop_name; const products = orderCard.product_info.item_groups; const productSumary = products .map((product) => product.items .map( (item) => item.name + “–amount: ” + item.amount + “–price: ” + _VietNamCurrency(item.item_price) ) .join(“, “) ) .join(“; “); const name = products[0].items[0].name; if (listType != 4 && listType != 12) sum += subTotal; else subTotal = 0;  const subTotalNative = _VietNamCurrency(subTotal); allOrders.push( [ name, productCount, subTotalNative, strListType, shopName, productSumary, subTotal, ].join(“\t”) ); } document.write(“  Đang xử lý đơn hàng shopee: ” + offset + “  “); offset += limit; }  allOrders.push([“Tổng cộng: “, count, _VietNamCurrency(sum)].join(“\t”)); var text = allOrders.join(“\r\n”);  return text; } let text = await getAllOrders();  document.write( “  Dữ liệu đơn hàng. Copy nội dung và dán vào file excel để xem kết quả  ” ); }, };`
